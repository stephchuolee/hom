<p id="notice"><%= notice %></p>

<h1>Listing Listings</h1>
<div id="filtered_search">
  <%= form_tag "/listings/filter", method: "get" do %>
  <%= label_tag(:min_price, "Min") %>
  <%= text_field_tag(:min_price) %>
  <%= label_tag(:max_price, "Max") %>
  <%= text_field_tag(:max_price) %>

  <%= label_tag(:pets, "Pets Allowed") %>
  <%= check_box_tag(:pets_btn) %>
  
  <%= submit_tag(:filter_submit, "Filter Search") %>
  <% end %> 
</div>

<table>
  <thead>
    <tr>
      <th>User</th>
      <th>Square footage</th>
      <th>Bedroom</th>
      <th>Bathroom</th>
      <th>Price</th>
      <th>Address</th>
      <th>Furnished</th>
      <th>Pets</th>
      <th>Smoking</th>
      <th>Floor number</th>
      <th>Parking space</th>
      <th>Storage space</th>
      <th>Balcony</th>
      <th>Available date</th>
      <th>Minimum lease</th>
      <th>Image</th>
      <th>Title</th>
      <th>Rental type</th>
      <th>Description</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @listings.each do |listing| %>
      <tr>
        <td><%= listing.user %></td>
        <td><%= listing.square_footage %></td>
        <td><%= listing.bedroom %></td>
        <td><%= listing.bathroom %></td>
        <td><%= listing.price %></td>
        <td><%= listing.address %></td>
        <td><%= listing.furnished %></td>
        <td class="pets"><%= listing.pets %></td>
        <td><%= listing.smoking %></td>
        <td><%= listing.floor_number %></td>
        <td><%= listing.parking_space %></td>
        <td><%= listing.storage_space %></td>
        <td><%= listing.balcony %></td>
        <td><%= listing.available_date %></td>
        <td><%= listing.minimum_lease %></td>
        <td>
        <% listing.listing_images.each do |array| %>
          <%= image_tag(array.image) %>
        <% end %>
        </td>
        <td><%= listing.title %></td>
        <td><%= listing.rental_type %></td>
        <td><%= listing.description %></td>
        <td><%= link_to 'Show', listing %></td>
        <td>

        <% if @current_user && @current_user.id == listing.user_id %>

          <%= link_to 'Edit', edit_user_listing_path(listing.user_id, listing.id) %></td>
          <td><%= link_to 'Destroy', listing, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<% if @current_user %> 
  <%= link_to 'New Listing', new_user_listing_path(@current_user.id) %>
<% end %> 
